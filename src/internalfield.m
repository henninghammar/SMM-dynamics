%Internal field in the QD due to the charge flow

ejxbare=2*1i*J*((epsilon*G0less+wL/2.*G1zless).*G1xgreat2-(epsilon*G0great+wL/2.*G1zgreat).*G1xless2...
    +(epsilon*G1xless-1i.*G1yless).*G0great2-(epsilon*G1xgreat-1i.*G1ygreat).*G0less2...
    -1i.*(epsilon*G1yless+1i.*G1xless).*G1zgreat2+1i.*(epsilon*G1zless+wL/2).*G1ygreat2...
    +1i.*(epsilon*G1ygreat+1i.*G1xgreat).*G1zless2-1i.*(epsilon*G1zgreat+wL/2).*G1yless2);
ejybare=2*1i*J*((epsilon*G0less+wL/2.*G1zless).*G1ygreat2-(epsilon*G0great+wL/2.*G1zgreat).*G1yless2...
    +(epsilon*G1yless+1i.*G1xless).*G0great2-(epsilon*G1ygreat+1i.*G1xgreat).*G0less2...
    -1i.*(epsilon*G1zless+wL/2).*G1xgreat2+1i.*(epsilon*G1xless-1i.*G1yless).*G1zgreat2...
    +1i.*(epsilon*G1zgreat+wL/2).*G1xless2-1i.*(epsilon*G1xgreat-1i.*G1ygreat).*G1zless2);
ejzbare=2*1i*J*((epsilon*G0less+wL/2.*G1zless).*G1zgreat2-(epsilon*G0great+wL/2.*G1zgreat).*G1zless2...
    +(epsilon*G1zless+wL/2).*G0great2-(epsilon*G1zgreat2+wL/2).*G0less2...
    -1i.*(epsilon*G1xless-1i.*G1yless).*G1ygreat2+1i.*(epsilon*G1yless+1i.*G1xless).*G1xgreat2...
    +1i.*(epsilon*G1xgreat-1i.*G1ygreat).*G1yless2-1i.*(epsilon*G1ygreat+1i.*G1xgreat).*G1xless2);

ejx=trapz(tau,ejxbare);
ejy=trapz(tau,ejybare);
ejz=trapz(tau,ejzbare);